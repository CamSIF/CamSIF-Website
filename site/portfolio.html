<!-- Use this for making new pages! -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cambridge Student Investment Fund</title>
    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon.ico">
    <link rel="stylesheet" href="../styles/template.css">
    <link rel="stylesheet" href="../styles/portfolio.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script>
      $(function(){
        $("#nav").load("../templates/nav.html"); 
      });
      $(function(){
        $("#footer").load("../templates/footer.html"); 
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>
  <body>
    <div id="nav"></div>
    <div id="main">
      <div class="section" id="performance">
        <h2>
          Portfolio Performance
        </h2>
        <div id="performance-graph-container">
          <canvas id="performance-graph"></canvas>
        </div>
        <h2 id="pnl-text">PnL: </h2>
      </div> 
      <div class="section" id="info">
        <h2>
          Portfolio Management Competition
        </h2>
        <p>
          To enhance the sector teams’ engagement beyond their termly stock pitch, 
          and to foster the sense of community for our members, this year we are bringing you CamSIF's flagship portfolio management competition.
        </p>
        <p>
          To provide timely and accurate data for our portfolios, we are proud to be partnering with <a href="https://www.tiingo.com/">Tiingo Stock APIs</a>.
        </p>

        <div>
          <h2>Sector Portfolios</h2>
          <p>
            Each sector team will be allocated a <b>simulated trading account</b> with a maximum of <b>5 long/short positions </b>at any time.
            Teams can update their position on a weekly basis as moderated by our Porfolio Managers. 
          </p>
        </div>
        <div>
          <h2>CamSIF Aggregated Portfolio</h2>
          <p>
            Each week, a new sector team will present an <b>investment pitch</b> for inclusion into our general portfolio,
            followed by a response pitch from our experienced Portfolio Managers. 
            <br><br>
            Our members will then vote on an investment decision. If successful, the investment will be made under 
            CamSIF’s aggregate portfolio.
          </p>
        </div>
      </div>
      
       
      
      <div class="section" id="download-template">
        <h2>
          For Sector Teams
        </h2>
        <p>
          Please find the Portfolio Management Guidelines and the Portfolio Adjustment Report template here:
        </p>
        <div id="download-buttons">
          <a class="template-download-button" href="/assets/files/CamSIF - 2023 Portfolio Guidelines and Template.docx">
            <i class="fa fa-solid fa-download"></i>.docx
          </a>
          <a class="template-download-button" href="/assets/files/CamSIF - 2023 Portfolio Guidelines and Template.pdf">
            <i class="fa fa-solid fa-download"></i>PDF
          </a>
        </div>
      </div>
    
    </div>
    <div id="footer"></div>
  </body>
  <script src="../js/main.js"></script>
  <script>
    Chart.defaults.borderColor = "#AAA3"
    Chart.defaults.color = '#FFF';
    (async function fetchData() {
      const req = new FormData();
      req.append("fund", "camsif_main");
      
      const response = await fetch(
        "http://portfolio.camsif.org/api/camsif_pnl",
        {
          method: "POST",
          body: req
        }
      );
      const data = await response.json();
      new Chart(
        document.getElementById('performance-graph'),
        {
          type: 'line',
          data: {
            labels: data.dates.map(date => date.substring(0,16)),
            datasets: [
              {
                label: 'Portfolio Value',
                data: data.values
              }
            ]
          },
          options: {
                scales: {
                    y: {
                        // suggestedMin: 9500000,
                        // suggestedMax: 10500000
                        grace: "200000"
                    },
                },
                responsive: true,
                maintainAspectRatio: false,
              }
        }
      );
      document.getElementById('pnl-text').innerHTML = "PnL: " + data.percentage_pnl + "%"
    })();

  </script>
</html>